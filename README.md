Finetuning google/gemma-2-9b-it or\
How to make an AI criminal assistant in 15 minutes
=============
Cсылка на jupyter notebook:
https://www.kaggle.com/code/lolikion228/gemmaft .

На данный момент существует множество LLM, которыми может свободно пользоваться кто угодно, при условии, что он обладает базовыми навыками взаимодействия с компьютером.\
В связи с этим, а так же с учётом неких моральных норм, в обучающих данных для LLM закладываются паттерны, которые впоследствии не позовлят модели вести диалог на темы по типу "как создать бомбу из аммиачной селитры".\
В рамках этого мини-проекта будет показано, что, при должном желании, можно поменять поведение модели как вам будет угодно.

Для осуществления данной идеи был использован датасет https://huggingface.co/datasets/Kofi24/offensive.\
Он состоит из пар ["question", "answer"], где "question" это вопрос по типу "как сделать что-то плохое", а "answer" это очень подробный ответ на данный вопрос. Прекрасно подходит для дообучения LLM.

C целью уменьшения расхода ресурсов было использовано 4-битное квантование модели в normal float.

Для дообучения был испольован метод Low Rank Adaptation (LoRA)
с параметрами rank=32, lora_alpha=64, lora_dropout=0.05.

В результате, количество обучамеых параметров составило всего лишь 116.3 млн (у исходной модели 9.3 млрд параметров).

Модель дообучалась на протяжении 64 эпох с batch_size=2 и learning_rate=5e-5. В качестве оптимизатора был выбран paged_adamw_8bit.

Время обучения модели составило всего лишь 587 секунд. С учётом времени на загрузку и подготовку данных, суммарное время работы пайплайна обучения составило 15 минут (без учёта времени на инференс для проверки результата).


Примеры
==========

Вот такой вот ответ вам выдаст Deepseek 
------
![Здесь могла быть красивая картинка #1](./imgs/ds.png)


Что-то похожее будет и на стандартной версии gemma-2-9b
--------------
![Здесь могла быть красивая картинка #2](./imgs/nonFT.png)

А вот что мы получаем после дообучения
--------------
![Здесь могла быть красивая картинка #2](./imgs/FT.png)

Теперь модель можно использовать, чтобы писать смешные планы. * только с целью посмеяться
------